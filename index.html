<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Insignia - Premium Rewards</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #818cf8;
      --secondary: #f59e0b;
      --accent: #10b981;
      --danger: #ef4444;
      --dark: #0f172a;
      --dark-card: #1e293b;
      --darker: #0a0f1c;
      --darker-alt: #050813;
      --light: #e2e8f0;
      --gray: #64748b;
      --gray-light: #cbd5e1;
      --border: rgba(255, 255, 255, 0.08);
      --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
      --shadow-lg: 0 20px 40px -10px rgba(0, 0, 0, 0.6);
      --gradient: linear-gradient(135deg, #6366f1, #8b5cf6, #d946ef);
      --gradient-dark: linear-gradient(135deg, #0a0f1c, #0f172a, #1e1b4b);
      --radius: 16px;
      --radius-sm: 8px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--darker-alt);
      color: var(--light);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.6;
      position: relative;
      -webkit-tap-highlight-color: transparent;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.08) 0%, transparent 60%),
        radial-gradient(circle at 80% 70%, rgba(219, 70, 239, 0.04) 0%, transparent 60%),
        var(--gradient-dark);
      pointer-events: none;
      z-index: -1;
    }

    .hidden { display: none !important; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 0.5rem; }
    .gap-4 { gap: 1rem; }
    .gap-6 { gap: 1.5rem; }
    .gap-8 { gap: 2rem; }
    .p-4 { padding: 1rem; }
    .p-6 { padding: 1.5rem; }
    .p-8 { padding: 2rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .text-center { text-align: center; }
    .text-sm { font-size: 0.875rem; }
    .text-lg { font-size: 1.125rem; }
    .text-xl { font-size: 1.25rem; }
    .text-2xl { font-size: 1.5rem; }
    .text-3xl { font-size: 1.875rem; }
    .text-4xl { font-size: 2.25rem; }
    .font-bold { font-weight: 700; }
    .font-semibold { font-weight: 600; }
    .w-full { width: 100%; }
    .h-full { height: 100%; }
    .relative { position: relative; }
    .absolute { position: absolute; }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    #loadingScreen {
      position: fixed;
      inset: 0;
      background: var(--darker-alt);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      backdrop-filter: blur(10px);
    }

    .loading-content {
      text-align: center;
      padding: 3rem;
      background: rgba(10, 15, 28, 0.9);
      border-radius: var(--radius);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-lg);
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 3px solid rgba(99, 102, 241, 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    #app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: transparent;
    }

    .navbar {
      background: transparent;
      position: sticky;
      top: 0;
      z-index: 1000;
      padding: 1rem 0;
      display: flex;
      justify-content: center;
      width: 100%;
    }

    .nav-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(25px);
      border: 1px solid var(--border);
      border-radius: 50px;
      padding: 0.5rem 1.5rem;
      width: 95%;
      max-width: 1300px;
      margin: 0 auto;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.5rem;
      font-weight: 800;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-left: 0.5rem;
    }

    .logo-icon {
      width: 36px;
      height: 36px;
      background: var(--gradient);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .menu-toggle {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: rgba(99, 102, 241, 0.15);
      border: 1px solid rgba(99, 102, 241, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      z-index: 1001;
      margin-right: 0.5rem;
    }

    .menu-toggle:hover {
      background: rgba(99, 102, 241, 0.25);
      transform: translateY(-2px) scale(1.05);
    }

    .dots-menu {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 4px;
      width: 24px;
      height: 24px;
    }

    .dot {
      width: 6px;
      height: 6px;
      background: var(--primary-light);
      border-radius: 50%;
      transition: var(--transition);
    }

    .menu-toggle.active .dots-menu {
      display: none;
    }

    .menu-toggle.active::before {
      content: 'Ã—';
      font-size: 32px;
      color: var(--primary-light);
      line-height: 1;
      margin-top: -4px;
    }

    .mobile-menu {
      position: fixed;
      top: 0;
      right: 0;
      width: 320px;
      height: 100vh;
      background: rgba(10, 15, 28, 0.98);
      backdrop-filter: blur(35px);
      border-left: 1px solid var(--border);
      padding: 5rem 2rem 2rem;
      transform: translateX(100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 999;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .mobile-menu.active {
      transform: translateX(0);
    }

    .menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      z-index: 998;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }

    .menu-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      border-radius: 12px;
      color: var(--light);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
      border: 1px solid transparent;
      background: rgba(30, 41, 59, 0.4);
      cursor: pointer;
    }

    .menu-item:hover {
      background: rgba(99, 102, 241, 0.2);
      border-color: rgba(99, 102, 241, 0.4);
      transform: translateX(5px);
    }

    .menu-item.active {
      background: linear-gradient(90deg, rgba(99, 102, 241, 0.3), rgba(99, 102, 241, 0.1));
      border-color: var(--primary);
      color: var(--primary-light);
    }

    .menu-item i {
      width: 24px;
      text-align: center;
      font-size: 1.1rem;
    }

    .desktop-nav {
      display: none;
      gap: 0.75rem;
      align-items: center;
      margin-right: 1rem;
    }

    @media (min-width: 1024px) {
      .desktop-nav {
        display: flex;
      }
      .menu-toggle {
        display: none;
      }
      .nav-container {
        padding: 0.5rem 2rem;
        width: 90%;
      }
    }

    .nav-button {
      padding: 0.75rem 1.75rem;
      background: rgba(99, 102, 241, 0.15);
      border: 1px solid rgba(99, 102, 241, 0.25);
      border-radius: 25px;
      color: var(--light);
      font-weight: 500;
      text-decoration: none;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      white-space: nowrap;
      cursor: pointer;
      border: none;
    }

    .nav-button:hover {
      background: rgba(99, 102, 241, 0.25);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(99, 102, 241, 0.25);
    }

    .nav-button.primary {
      background: var(--gradient);
      border: none;
      color: white;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }

    .nav-button.primary:hover {
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
      transform: translateY(-3px);
    }

    .auth-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem;
      background: transparent;
    }

    .auth-card {
      width: 100%;
      max-width: 440px;
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(25px);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 2.5rem;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .auth-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient);
    }

    .auth-title {
      font-size: 2rem;
      font-weight: 800;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 0.5rem;
      text-align: center;
    }

    .auth-subtitle {
      color: var(--gray);
      text-align: center;
      margin-bottom: 2rem;
    }

    .input-group {
      margin-bottom: 1.5rem;
    }

    .input-label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--gray-light);
      font-weight: 500;
    }

    .input-field {
      width: 100%;
      padding: 1rem;
      background: rgba(10, 15, 28, 0.7);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--light);
      font-size: 1rem;
      transition: var(--transition);
      outline: none;
    }

    .input-field:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    .input-field::placeholder {
      color: var(--gray);
    }

    .btn {
      padding: 1rem 2rem;
      background: var(--gradient);
      border: none;
      border-radius: var(--radius-sm);
      color: white;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      width: 100%;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary-light);
    }

    .auth-link {
      text-align: center;
      margin-top: 1.5rem;
      color: var(--gray);
    }

    .auth-link a {
      color: var(--primary-light);
      text-decoration: none;
      font-weight: 600;
      cursor: pointer;
    }

    .auth-link a:hover {
      text-decoration: underline;
    }

    .verification-container {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      margin: 2rem 0;
    }

    .code-input {
      width: 50px;
      height: 60px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      background: rgba(10, 15, 28, 0.7);
      border: 2px solid var(--border);
      border-radius: 10px;
      color: var(--light);
      transition: var(--transition);
    }

    .code-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
      transform: scale(1.05);
    }

    .dashboard {
      flex: 1;
      padding: 2rem 1rem;
      background: transparent;
    }

    .profile-header {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.85), rgba(10, 15, 28, 0.85));
      backdrop-filter: blur(25px);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 2rem;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .avatar {
      width: 80px;
      height: 80px;
      background: var(--gradient);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: 700;
      color: white;
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
    }

    .user-info {
      flex: 1;
    }

    .username {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .user-status {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border-radius: 20px;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .balance-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .balance-card {
      background: rgba(15, 23, 42, 0.7);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 1.5rem;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .balance-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient);
    }

    .balance-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary);
    }

    .balance-label {
      color: var(--gray);
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .balance-value {
      font-size: 2rem;
      font-weight: 800;
      color: var(--light);
    }

    .balance-value.primary {
      color: var(--primary-light);
    }

    .balance-value.success {
      color: var(--accent);
    }

    .tabs {
      display: flex;
      gap: 0.5rem;
      overflow-x: auto;
      padding: 0.5rem;
      margin-bottom: 2rem;
      background: rgba(10, 15, 28, 0.7);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      backdrop-filter: blur(10px);
      scrollbar-width: none;
    }

    .tabs::-webkit-scrollbar {
      display: none;
    }

    .tab-button {
      padding: 0.75rem 1.5rem;
      background: transparent;
      border: none;
      border-radius: 25px;
      color: var(--gray);
      font-weight: 500;
      white-space: nowrap;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tab-button:hover {
      background: rgba(99, 102, 241, 0.15);
      color: var(--light);
    }

    .tab-button.active {
      background: var(--gradient);
      color: white;
      box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
    }

    .content-page {
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(25px);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 2rem;
      margin-bottom: 2rem;
      min-height: 400px;
    }

    .page-title {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .page-title::after {
      content: '';
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), transparent);
      margin-left: 1rem;
    }

    .work-description {
      background: rgba(10, 15, 28, 0.7);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 4px solid var(--primary);
    }

    .work-textarea {
      width: 100%;
      min-height: 150px;
      padding: 1rem;
      background: rgba(10, 15, 28, 0.7);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--light);
      font-size: 1rem;
      margin-bottom: 1.5rem;
      resize: vertical;
      outline: none;
      transition: var(--transition);
    }

    .work-textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    .offerwall-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .offerwall-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(10, 15, 28, 0.9));
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 1.5rem;
      transition: var(--transition);
      backdrop-filter: blur(10px);
    }

    .offerwall-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary);
    }

    .offerwall-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .offerwall-icon {
      width: 48px;
      height: 48px;
      background: var(--gradient);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.25rem;
    }

    .offerwall-status {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .offerwall-status.unlocked {
      background: rgba(16, 185, 129, 0.2);
      color: var(--accent);
    }

    .offerwall-status.locked {
      background: rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }

    .bonus-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .bonus-input-group {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .bonus-input {
      flex: 1;
      padding: 1rem;
      background: rgba(10, 15, 28, 0.7);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--light);
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .bonus-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .bonus-item {
      background: rgba(10, 15, 28, 0.7);
      border-radius: var(--radius-sm);
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid var(--border);
      transition: var(--transition);
      backdrop-filter: blur(5px);
    }

    .bonus-item:hover {
      transform: translateX(5px);
      border-color: var(--primary);
    }

    .bonus-code {
      font-family: 'Courier New', monospace;
      font-weight: 700;
      color: var(--primary-light);
      font-size: 1.1rem;
    }

    .bonus-reward {
      color: var(--accent);
      font-weight: 600;
    }

    .cashout-form {
      max-width: 400px;
      margin: 0 auto 2rem;
    }

    .reward-select {
      width: 100%;
      padding: 1rem;
      background: rgba(10, 15, 28, 0.7);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--light);
      font-size: 1rem;
      margin-bottom: 1.5rem;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236366f1'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1.5rem;
    }

    .cashout-history {
      margin-top: 3rem;
    }

    .history-item {
      background: rgba(10, 15, 28, 0.7);
      border-radius: var(--radius-sm);
      padding: 1rem;
      margin-bottom: 1rem;
      border-left: 4px solid var(--primary);
      transition: var(--transition);
      backdrop-filter: blur(5px);
    }

    .history-item:hover {
      transform: translateX(5px);
    }

    .history-status {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }

    .status-pending { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    .status-approved { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    .status-rejected { background: rgba(239, 68, 68, 0.2); color: #ef4444; }

    .chat-toggle {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      background: var(--gradient);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
      z-index: 990;
      transition: var(--transition);
    }

    .chat-toggle:hover {
      transform: scale(1.1) rotate(10deg);
      box-shadow: 0 15px 30px rgba(99, 102, 241, 0.5);
    }

    .chat-box {
      position: fixed;
      bottom: 5rem;
      right: 2rem;
      width: 350px;
      height: 500px;
      background: rgba(10, 15, 28, 0.95);
      backdrop-filter: blur(25px);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-lg);
      display: flex;
      flex-direction: column;
      z-index: 989;
      transform: translateY(20px);
      opacity: 0;
      pointer-events: none;
      transition: var(--transition);
    }

    .chat-box.active {
      transform: translateY(0);
      opacity: 1;
      pointer-events: all;
    }

    .chat-header {
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.25), rgba(139, 92, 246, 0.15));
      border-radius: var(--radius) var(--radius) 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chat-close {
      background: none;
      border: none;
      color: var(--gray);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0;
      width: 24px;
      height: 24px;
    }

    .chat-messages {
      flex: 1;
      padding: 1rem;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .chat-message {
      max-width: 80%;
      padding: 0.75rem 1rem;
      border-radius: 1rem;
      font-size: 0.875rem;
    }

    .chat-message.own {
      background: var(--gradient);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .chat-message.other {
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid var(--border);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .chat-input-container {
      padding: 1rem;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 0.5rem;
    }

    .chat-input {
      flex: 1;
      padding: 0.75rem 1rem;
      background: rgba(10, 15, 28, 0.7);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--light);
      font-size: 0.875rem;
      outline: none;
    }

    .chat-send {
      width: 44px;
      height: 44px;
      background: var(--gradient);
      border: none;
      border-radius: var(--radius-sm);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(15px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }

    .modal-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .modal {
      background: rgba(10, 15, 28, 0.95);
      backdrop-filter: blur(35px);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 2rem;
      max-width: 400px;
      width: 90%;
      box-shadow: var(--shadow-lg);
      transform: translateY(20px);
      transition: transform 0.3s;
    }

    .modal-overlay.active .modal {
      transform: translateY(0);
    }

    .modal-message {
      text-align: center;
      margin-bottom: 1.5rem;
      color: var(--light);
      font-size: 1.1rem;
    }

    .footer {
      background: rgba(10, 15, 28, 0.9);
      border-top: 1px solid var(--border);
      padding: 2rem 1rem;
      margin-top: auto;
      backdrop-filter: blur(20px);
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      text-align: center;
      color: var(--gray);
    }

    /* Screen Sharing Styles */
    .screen-share-container {
      background: rgba(10, 15, 28, 0.7);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid var(--border);
    }

    .screen-preview {
      width: 100%;
      height: 200px;
      background: #000;
      border-radius: var(--radius-sm);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray);
    }

    .screen-preview video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: var(--radius-sm);
    }

    @media (max-width: 768px) {
      .nav-container {
        width: 92%;
        padding: 0.4rem 1.25rem;
        border-radius: 40px;
        margin: 0.5rem auto;
      }
      
      .auth-card {
        padding: 1.75rem;
      }
      
      .profile-header {
        flex-direction: column;
        text-align: center;
      }
      
      .balance-grid {
        grid-template-columns: 1fr;
      }
      
      .content-page {
        padding: 1.5rem;
      }
      
      .offerwall-grid,
      .bonus-grid {
        grid-template-columns: 1fr;
      }
      
      .bonus-input-group {
        flex-direction: column;
      }
      
      .chat-box {
        width: calc(100% - 2rem);
        right: 1rem;
        bottom: 4rem;
        height: 400px;
      }
      
      .verification-container {
        gap: 0.5rem;
      }
      
      .code-input {
        width: 45px;
        height: 55px;
        font-size: 1.25rem;
      }
      
      .mobile-menu {
        width: 85%;
      }
    }

    @media (max-width: 480px) {
      .content-page {
        padding: 1.25rem;
      }
      
      .auth-card {
        padding: 1.5rem;
      }
      
      .auth-title {
        font-size: 1.75rem;
      }
      
      .page-title {
        font-size: 1.5rem;
      }
      
      .balance-value {
        font-size: 1.75rem;
      }
      
      .mobile-menu {
        width: 90%;
        padding: 4rem 1.5rem 1.5rem;
      }
      
      .chat-toggle {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
        bottom: 1.5rem;
        right: 1.5rem;
      }
      
      .nav-container {
        padding: 0.35rem 1rem;
        border-radius: 35px;
      }
      
      .logo {
        font-size: 1.3rem;
      }
      
      .logo-icon {
        width: 32px;
        height: 32px;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2 class="text-2xl font-bold mb-2">Loading Insignia</h2>
      <p class="text-gray">Initializing premium experience...</p>
    </div>
  </div>

  <!-- App Container -->
  <div id="app" class="hidden">
    <!-- Navbar -->
    <nav class="navbar">
      <div class="container nav-container">
        <!-- Logo -->
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-q"></i>
          </div>
          <span>UIZBUX</span>
        </div>

        <!-- Desktop Navigation -->
        <div class="desktop-nav">
          <button class="nav-button" onclick="showPage('work')">
            <i class="fas fa-briefcase"></i>
            Tasks
          </button>
          <button class="nav-button" onclick="showPage('offerwalls')">
            <i class="fas fa-gem"></i>
            Offerwalls
          </button>
          <button class="nav-button" onclick="showPage('bonus')">
            <i class="fas fa-gift"></i>
            Bonus
          </button>
          <button class="nav-button" onclick="showPage('cashout')">
            <i class="fas fa-wallet"></i>
            Cashout
          </button>
          <button class="nav-button" onclick="startScreenShare()" id="screenShareBtn">
            <i class="fas fa-desktop"></i>
            Screen Share
          </button>
          <button class="nav-button" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            Logout
          </button>
        </div>

        <!-- 9-Dot Menu Toggle -->
        <button class="menu-toggle" onclick="toggleMenu()">
          <div class="dots-menu">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
        </button>
      </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="menu-overlay" onclick="toggleMenu()"></div>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
      <button class="menu-item" onclick="showPage('work'); toggleMenu()">
        <i class="fas fa-briefcase"></i>
        <span>Tasks</span>
      </button>
      <button class="menu-item" onclick="showPage('offerwalls'); toggleMenu()">
        <i class="fas fa-gem"></i>
        <span>Offerwalls</span>
      </button>
      <button class="menu-item" onclick="showPage('bonus'); toggleMenu()">
        <i class="fas fa-gift"></i>
        <span>Bonus Codes</span>
      </button>
      <button class="menu-item" onclick="showPage('cashout'); toggleMenu()">
        <i class="fas fa-wallet"></i>
        <span>Cashout</span>
      </button>
      <button class="menu-item" onclick="startScreenShare(); toggleMenu()">
        <i class="fas fa-desktop"></i>
        <span>Screen Share</span>
      </button>
      <button class="menu-item" onclick="showPage('terms'); toggleMenu()">
        <i class="fas fa-file-contract"></i>
        <span>Terms</span>
      </button>
      <button class="menu-item" onclick="toggleChat(); toggleMenu()">
        <i class="fas fa-comments"></i>
        <span>Support</span>
      </button>
      <button class="menu-item" onclick="showAlert('Contact: support@insignia.com'); toggleMenu()">
        <i class="fas fa-question-circle"></i>
        <span>Help</span>
      </button>
      <button class="menu-item" onclick="logout(); toggleMenu()">
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </button>
    </div>

    <!-- Auth Screens -->
    <div id="authScreens">
      <div class="auth-container">
        <!-- Login Card -->
        <div id="loginCard" class="auth-card">
          <h1 class="auth-title">Welcome Back</h1>
          <p class="auth-subtitle">Sign in to access your premium account</p>
          
          <div class="input-group">
            <label class="input-label">Username</label>
            <input type="text" id="loginUsername" class="input-field" placeholder="Enter your username" autocomplete="off">
          </div>
          
          <div class="input-group">
            <label class="input-label">Password</label>
            <input type="password" id="loginPassword" class="input-field" placeholder="Enter your password" autocomplete="off">
          </div>
          
          <button class="btn" onclick="login()" id="loginBtn">
            <i class="fas fa-sign-in-alt"></i>
            Access Account
          </button>
          
          <div class="auth-link">
            New to Insignia? <a onclick="showSignup()">Create account</a>
          </div>
        </div>

        <!-- Signup Card -->
        <div id="signupCard" class="auth-card hidden">
          <h1 class="auth-title">Join Insignia</h1>
          <p class="auth-subtitle">Create your premium account today</p>
          
          <div class="input-group">
            <label class="input-label">Username</label>
            <input type="text" id="signupUsername" class="input-field" placeholder="Choose a username" autocomplete="off">
          </div>
          
          <div class="input-group">
            <label class="input-label">Email</label>
            <input type="email" id="signupEmail" class="input-field" placeholder="Enter your email" autocomplete="off">
          </div>
          
          <div class="input-group">
            <label class="input-label">Password</label>
            <input type="password" id="signupPassword" class="input-field" placeholder="Create a password" autocomplete="off">
          </div>
          
          <button class="btn" onclick="signup()" id="signupBtn">
            <i class="fas fa-user-plus"></i>
            Create Account
          </button>
          
          <div class="auth-link">
            Already have an account? <a onclick="showLogin()">Sign in</a>
          </div>
        </div>

        <!-- Verification Card -->
        <div id="verifyCard" class="auth-card hidden">
          <h1 class="auth-title">Verify Identity</h1>
          <p class="auth-subtitle">Enter the 6-digit code sent to your email</p>
          
          <div class="verification-container">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 0)">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 1)">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 2)">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 3)">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 4)">
            <input type="text" class="code-input" maxlength="1" oninput="moveToNext(this, 5)">
          </div>
          
          <button class="btn" onclick="verifyEmail()" id="verifyBtn">
            <i class="fas fa-check-circle"></i>
            Verify & Continue
          </button>
          
          <div class="auth-link">
            Didn't receive code? <a onclick="resendCode()">Resend</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard hidden">
      <div class="container">
        <!-- Profile Header -->
        <div class="profile-header">
          <div class="avatar" id="userAvatar">U</div>
          <div class="user-info">
            <h2 class="username" id="displayUsername">User</h2>
            <span class="user-status" id="userStatus">Premium Member</span>
          </div>
        </div>

        <!-- Balance Cards -->
        <div class="balance-grid">
          <div class="balance-card">
            <div class="balance-label">Points Balance</div>
            <div class="balance-value primary" id="balanceValue">0</div>
          </div>
          <div class="balance-card">
            <div class="balance-label">USD Balance</div>
            <div class="balance-value" id="usdBalanceValue">$0.0000</div>
          </div>
          <div class="balance-card">
            <div class="balance-label">Bonus Points</div>
            <div class="balance-value success" id="bonusPointsValue">0</div>
          </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
          <button class="tab-button active" onclick="showPage('work')">
            <i class="fas fa-briefcase"></i>
            Tasks
          </button>
          <button class="tab-button" onclick="showPage('offerwalls')">
            <i class="fas fa-gem"></i>
            Offerwalls
          </button>
          <button class="tab-button" onclick="showPage('bonus')">
            <i class="fas fa-gift"></i>
            Bonus Codes
          </button>
          <button class="tab-button" onclick="showPage('cashout')">
            <i class="fas fa-wallet"></i>
            Cashout
          </button>
          <button class="tab-button" onclick="startScreenShare()">
            <i class="fas fa-desktop"></i>
            Screen Share
          </button>
        </div>

        <!-- Content Pages -->
        <div id="pages">
          <!-- Work Page -->
          <div id="work" class="content-page">
            <h2 class="page-title">
              <i class="fas fa-briefcase"></i>
              Complete Tasks
            </h2>
            
            <div class="work-description">
              <p><strong>How it works:</strong></p>
              <p>Each question you read and each answer you submit earns you rewards</p>
              <p>5 Points + $0.005 USD for each approved submission</p>
              <p>You can also use Screen Share for additional rewards</p>
            </div>
            
            <textarea id="workInput" class="work-textarea" placeholder="Describe what questions you answered today..."></textarea>
            
            <div class="flex gap-4">
              <button class="btn" onclick="submitWork()" id="submitWorkBtn">
                <i class="fas fa-paper-plane"></i>
                Submit Work
              </button>
              <button class="btn btn-outline" onclick="startScreenShare()">
                <i class="fas fa-desktop"></i>
                Start Screen Share
              </button>
            </div>
          </div>

          <!-- Offerwalls Page -->
          <div id="offerwalls" class="content-page hidden">
            <h2 class="page-title">
              <i class="fas fa-gem"></i>
              Offerwalls
            </h2>
            
            <div id="offerwallList" class="offerwall-grid">
              <p>Loading offerwalls...</p>
            </div>
            
            <div id="iframeContainer" class="hidden">
              <iframe id="offerwallFrame" class="w-full" style="height: 600px; border: none; border-radius: var(--radius);"></iframe>
              <button class="btn btn-outline mt-4" onclick="closeIframe()">
                <i class="fas fa-arrow-left"></i>
                Back to Offerwalls
              </button>
            </div>
          </div>

          <!-- Bonus Codes Page -->
          <div id="bonus" class="content-page hidden">
            <h2 class="page-title">
              <i class="fas fa-gift"></i>
              Bonus Codes
            </h2>
            
            <div class="bonus-grid">
              <div class="balance-card">
                <h3 class="font-semibold mb-4">Redeem Code</h3>
                <div class="bonus-input-group">
                  <input type="text" id="bonusCodeInput" class="bonus-input" placeholder="ENTER-CODE-HERE" maxlength="20">
                  <button class="btn" onclick="redeemBonusCode()" id="redeemBonusBtn">
                    <i class="fas fa-ticket-alt"></i>
                    Redeem
                  </button>
                </div>
              </div>
              
              <div class="balance-card">
                <h3 class="font-semibold mb-4">Available Codes</h3>
                <div id="availableBonusCodes" class="bonus-list">
                  <p>Loading available codes...</p>
                </div>
              </div>
            </div>
            
            <div class="balance-card">
              <h3 class="font-semibold mb-4">Redemption History</h3>
              <div id="bonusHistory">
                <p>Loading redemption history...</p>
              </div>
            </div>
          </div>

          <!-- Cashout Page -->
          <div id="cashout" class="content-page hidden">
            <h2 class="page-title">
              <i class="fas fa-wallet"></i>
              Request Cashout
            </h2>
            
            <div class="work-description">
              <p><strong>Cashout Information:</strong></p>
              <p>1 USD = 1000 PTS</p>
              <p>Minimum cashout: $5.00</p>
              <p>Processing time: 3-7 business days</p>
            </div>
            
            <div class="cashout-form">
              <select id="rewardSelect" class="reward-select">
                <option value="">Select reward...</option>
                <option value="5">$5.00 USD (PayPal)</option>
                <option value="10">$10.00 USD (PayPal)</option>
                <option value="20">$20.00 USD (PayPal)</option>
                <option value="50">$50.00 USD (PayPal)</option>
                <option value="100">$100.00 USD (PayPal)</option>
              </select>
              
              <button id="cashoutBtn" class="btn" onclick="submitCashout()" disabled>
                <i class="fas fa-coins"></i>
                Request Cashout
              </button>
            </div>
            
            <div class="cashout-history">
              <h3 class="font-semibold mb-4">Cashout History</h3>
              <div id="cashoutHistory">
                <p>Loading history...</p>
              </div>
            </div>
          </div>

          <!-- Terms Page -->
          <div id="terms" class="content-page hidden">
            <h2 class="page-title">
              <i class="fas fa-file-contract"></i>
              Terms & Conditions
            </h2>
            
            <div id="termsContent">
              <h3>Welcome to Insignia Premium Rewards</h3>
              <p>By using our service, you agree to the following terms:</p>
              <ul>
                <li>You must be at least 18 years old to participate</li>
                <li>One account per person is allowed</li>
                <li>Fraudulent activities will result in account termination</li>
                <li>Rewards are subject to approval</li>
                <li>Minimum cashout: $5.00 USD</li>
                <li>Processing time: 3-7 business days</li>
                <li>Screen sharing is optional and only for verification purposes</li>
                <li>We never access your personal files during screen sharing</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <p>Â© 2024 Insignia Premium Rewards. All rights reserved.</p>
        <p class="text-sm mt-2">Product â€¢ Usecases â€¢ Resources â€¢ Company</p>
      </div>
    </footer>
  </div>

  <!-- Chat System -->
  <button id="chatToggle" class="chat-toggle hidden">
    <i class="fas fa-comment-dots"></i>
  </button>
  
  <div id="chatBox" class="chat-box">
    <div class="chat-header">
      <span><i class="fas fa-headset"></i> Premium Support</span>
      <button class="chat-close" onclick="toggleChat()">Ã—</button>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <div class="chat-message other">
        <strong>Insignia Support:</strong> Welcome to Insignia Premium! How can we assist you today?
      </div>
    </div>
    
    <div class="chat-input-container">
      <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." onkeypress="handleChatInput(event)">
      <button class="chat-send" onclick="sendChatMessage()">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>

  <!-- Modal -->
  <div id="alertModal" class="modal-overlay">
    <div class="modal">
      <p id="alertMessage" class="modal-message">Message</p>
      <button class="btn" onclick="closeAlert()">Continue</button>
    </div>
  </div>

  <script>
    // Your Google Apps Script URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwTelvEYce1YEgw8-RDKth6xa_VJGRu2YOTxRMcgTGLuL6IXgO7tFG3xllYW4czAdbEEg/exec";

    let currentUser = null;
    let pendingUser = null;
    let chatInterval = null;
    let screenStream = null;
    let isScreenSharing = false;

    // Initialize the app
    async function init() {
      console.log('ðŸš€ Initializing Insignia...');
      
      try {
        // Test connection to Google Apps Script
        const testResponse = await fetch(SCRIPT_URL + '?action=test');
        const testData = await testResponse.json();
        
        if (testData.status === 'success') {
          console.log('âœ… Connection test successful');
          
          // Show app after loading
          setTimeout(() => {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            // Try auto-login
            const saved = localStorage.getItem('quizbux_user');
            if (saved) {
              const userData = JSON.parse(saved);
              restoreSession(userData.username);
            }
          }, 1000);
          
        } else {
          throw new Error('Connection test failed: ' + testData.message);
        }
        
      } catch (error) {
        console.error('âŒ Initialization failed:', error);
        showAlert('Failed to connect to server. Please check your internet connection and try again.');
        document.getElementById('loadingScreen').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
      }
      
      // Add event listeners for Enter key
      setupEventListeners();
    }

    // Setup event listeners
    function setupEventListeners() {
      // Login form
      document.getElementById('loginPassword').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') login();
      });
      
      // Signup form
      document.getElementById('signupPassword').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') signup();
      });
      
      // Work input
      document.getElementById('workInput').addEventListener('keypress', (e) => {
        if (e.ctrlKey && e.key === 'Enter') submitWork();
      });
      
      // Bonus code input
      document.getElementById('bonusCodeInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') redeemBonusCode();
      });
      
      // Chat input
      document.getElementById('chatInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendChatMessage();
      });
      
      // Code inputs
      document.querySelectorAll('.code-input').forEach((input, index) => {
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Backspace' && !input.value && index > 0) {
            document.querySelectorAll('.code-input')[index - 1].focus();
          }
        });
      });
    }

    // Screen Sharing Function
    async function startScreenShare() {
      try {
        if (!currentUser) {
          showAlert('Please login first to use screen sharing');
          return;
        }
        
        if (isScreenSharing) {
          showAlert('Screen sharing is already active');
          return;
        }
        
        showAlert('Select screen or window to share. You will earn bonus points!');
        
        const stream = await navigator.mediaDevices.getDisplayMedia({
          video: {
            displaySurface: 'browser',
            cursor: 'always'
          },
          audio: false
        });
        
        screenStream = stream;
        isScreenSharing = true;
        
        // Update screen share button
        document.getElementById('screenShareBtn').innerHTML = '<i class="fas fa-stop"></i> Stop Sharing';
        document.getElementById('screenShareBtn').onclick = stopScreenShare;
        
        // Award points for screen sharing
        await recordScreenShare();
        
        // Handle when user stops sharing
        stream.getVideoTracks()[0].addEventListener('ended', () => {
          stopScreenShare();
        });
        
        showAlert('Screen sharing started! +10 points awarded.');
        
      } catch (error) {
        console.error('Screen sharing error:', error);
        if (error.name !== 'NotAllowedError') {
          showAlert('Failed to start screen sharing: ' + error.message);
        }
        isScreenSharing = false;
      }
    }

    async function recordScreenShare() {
      if (!currentUser) return;
      
      try {
        const formData = new FormData();
        formData.append('action', 'recordScreenShare');
        formData.append('username', currentUser.username);
        
        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          body: formData
        });
        
        const data = await response.json();
        if (data.status === 'success') {
          if (data.userData) {
            currentUser = data.userData;
            updateUserDisplay();
          }
        }
      } catch (error) {
        console.error('Record screen share error:', error);
      }
    }

    function stopScreenShare() {
      if (screenStream) {
        screenStream.getTracks().forEach(track => track.stop());
        screenStream = null;
      }
      isScreenSharing = false;
      
      // Update screen share button
      document.getElementById('screenShareBtn').innerHTML = '<i class="fas fa-desktop"></i> Screen Share';
      document.getElementById('screenShareBtn').onclick = startScreenShare;
      
      showAlert('Screen sharing stopped.');
    }

    // Auth functions
    function showLogin() {
      document.getElementById('signupCard').classList.add('hidden');
      document.getElementById('verifyCard').classList.add('hidden');
      document.getElementById('loginCard').classList.remove('hidden');
    }

    function showSignup() {
      document.getElementById('loginCard').classList.add('hidden');
      document.getElementById('verifyCard').classList.add('hidden');
      document.getElementById('signupCard').classList.remove('hidden');
    }

    function showVerification() {
      document.getElementById('loginCard').classList.add('hidden');
      document.getElementById('signupCard').classList.add('hidden');
      document.getElementById('verifyCard').classList.remove('hidden');
      document.querySelectorAll('.code-input').forEach(input => input.value = '');
      document.querySelectorAll('.code-input')[0].focus();
    }

    function moveToNext(input, index) {
      if (input.value.length === 1) {
        const nextInput = document.querySelectorAll('.code-input')[index + 1];
        if (nextInput) nextInput.focus();
      } else if (input.value.length === 0 && index > 0) {
        const prevInput = document.querySelectorAll('.code-input')[index - 1];
        if (prevInput) prevInput.focus();
      }
    }

    async function signup() {
      const username = document.getElementById('signupUsername').value.trim();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value;

      if (!username || !email || !password) {
        return showAlert('Please fill all fields');
      }

      if (username.length < 3) {
        return showAlert('Username must be at least 3 characters');
      }

      if (password.length < 6) {
        return showAlert('Password must be at least 6 characters');
      }

      // Disable button
      const btn = document.getElementById('signupBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';

      const formData = new FormData();
      formData.append('action', 'signup');
      formData.append('username', username);
      formData.append('email', email);
      formData.append('password', password);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();

        if (data.status === 'success') {
          pendingUser = { username, email, password };
          showVerification();
          showAlert('Verification code sent to your email!');
        } else {
          showAlert(data.message || 'Signup failed');
        }
      } catch (error) {
        console.error('Signup error:', error);
        showAlert('Network error. Please try again.');
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-user-plus"></i> Create Account';
      }
    }

    async function verifyEmail() {
      const codeInputs = document.querySelectorAll('.code-input');
      const code = Array.from(codeInputs).map(input => input.value).join('');

      if (code.length !== 6) {
        return showAlert('Please enter the 6-digit code');
      }

      // Disable button
      const btn = document.getElementById('verifyBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';

      const formData = new FormData();
      formData.append('action', 'verifyEmail');
      formData.append('username', pendingUser.username);
      formData.append('email', pendingUser.email);
      formData.append('password', pendingUser.password);
      formData.append('code', code);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();

        if (data.status === 'success') {
          showAlert('Account verified successfully! You can now login.');
          showLogin();
          pendingUser = null;
        } else {
          showAlert(data.message || 'Verification failed');
        }
      } catch (error) {
        console.error('Verification error:', error);
        showAlert('Network error. Please try again.');
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-check-circle"></i> Verify & Continue';
      }
    }

    async function resendCode() {
      if (!pendingUser) return;

      const formData = new FormData();
      formData.append('action', 'resendCode');
      formData.append('username', pendingUser.username);
      formData.append('email', pendingUser.email);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();

        if (data.status === 'success') {
          showAlert('New verification code sent!');
        } else {
          showAlert(data.message || 'Failed to resend code');
        }
      } catch (error) {
        console.error('Resend code error:', error);
        showAlert('Network error. Please try again.');
      }
    }

    async function login() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!username || !password) {
        return showAlert('Please fill all fields');
      }

      // Disable button
      const btn = document.getElementById('loginBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';

      const formData = new FormData();
      formData.append('action', 'login');
      formData.append('username', username);
      formData.append('password', password);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();

        if (data.status === 'success') {
          currentUser = data.user;
          localStorage.setItem('quizbux_user', JSON.stringify({ username }));
          showDashboard();
          showAlert('Login successful! Welcome to Insignia.');
        } else {
          showAlert(data.message || 'Login failed');
        }
      } catch (error) {
        console.error('Login error:', error);
        showAlert('Network error. Please check your connection and try again.');
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Access Account';
      }
    }

    async function restoreSession(username) {
      try {
        const response = await fetch(SCRIPT_URL + '?action=getUserData&username=' + encodeURIComponent(username));
        const data = await response.json();
        
        if (data.status === 'success') {
          currentUser = data.user;
          showDashboard();
        } else {
          localStorage.removeItem('quizbux_user');
        }
      } catch (error) {
        console.error('Restore session error:', error);
        localStorage.removeItem('quizbux_user');
      }
    }

    function updateUserDisplay() {
      if (!currentUser) return;
      
      document.getElementById('displayUsername').textContent = currentUser.username;
      document.getElementById('userAvatar').textContent = currentUser.username[0].toUpperCase();
      document.getElementById('balanceValue').textContent = Number(currentUser.balance || 0).toLocaleString();
      document.getElementById('usdBalanceValue').textContent = '$' + (Number(currentUser.balanceUSD || 0)).toFixed(4);
      document.getElementById('bonusPointsValue').textContent = Number(currentUser.bonusPoints || 0).toLocaleString();
      
      // Update status
      const statusEl = document.getElementById('userStatus');
      if (currentUser.isPremium) {
        statusEl.textContent = 'Premium Member';
        statusEl.style.background = 'linear-gradient(135deg, #8b5cf6, #6366f1)';
      } else {
        statusEl.textContent = 'Standard Member';
        statusEl.style.background = 'linear-gradient(135deg, #10b981, #059669)';
      }
    }

    function showDashboard() {
      document.getElementById('authScreens').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      document.getElementById('chatToggle').classList.remove('hidden');

      updateUserDisplay();
      showPage('work');
    }

    function showPage(id) {
      // Hide all content pages
      document.querySelectorAll('.content-page').forEach(p => p.classList.add('hidden'));
      
      // Show selected page
      document.getElementById(id).classList.remove('hidden');
      
      // Update active tab
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(btn => {
        if (btn.onclick && btn.onclick.toString().includes(`'${id}'`)) {
          btn.classList.add('active');
        }
      });
      
      // Load page-specific content
      if (id === 'offerwalls') loadOfferwalls();
      if (id === 'cashout') loadCashoutHistory();
      if (id === 'bonus') loadBonusCodes();
    }

    function toggleMenu() {
      document.querySelector('.menu-toggle').classList.toggle('active');
      document.querySelector('.mobile-menu').classList.toggle('active');
      document.querySelector('.menu-overlay').classList.toggle('active');
    }

    // Work submission
    async function submitWork() {
      if (!currentUser) {
        showAlert('Please login first');
        return;
      }

      const text = document.getElementById('workInput').value.trim();
      if (!text) return showAlert('Please describe the questions you answered');

      // Disable button
      const btn = document.getElementById('submitWorkBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';

      const formData = new FormData();
      formData.append('action', 'submitWork');
      formData.append('username', currentUser.username);
      formData.append('submission', text);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();
        showAlert(data.message);
        document.getElementById('workInput').value = '';
        
        // Update user data
        if (data.userData) {
          currentUser = data.userData;
          updateUserDisplay();
        }
      } catch (error) {
        console.error('Submit work error:', error);
        showAlert('Network error. Please try again.');
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Work';
      }
    }

    // Cashout functions
    document.getElementById('rewardSelect').onchange = function() {
      document.getElementById('cashoutBtn').disabled = !this.value;
    };

    async function submitCashout() {
      if (!currentUser) return;

      const amount = document.getElementById('rewardSelect').value;
      if (!amount) return showAlert('Please select a reward');

      const reward = document.getElementById('rewardSelect').selectedOptions[0].text;

      const requiredPoints = amount * 1000;
      if (currentUser.balance < requiredPoints) {
        return showAlert(`You need ${requiredPoints} points for this cashout. Current: ${currentUser.balance} points`);
      }

      const formData = new FormData();
      formData.append('action', 'submitCashout');
      formData.append('username', currentUser.username);
      formData.append('reward', reward);
      formData.append('amount', amount);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();
        showAlert(data.message);

        document.getElementById('rewardSelect').value = '';
        document.getElementById('cashoutBtn').disabled = true;
        
        // Update user data
        if (data.userData) {
          currentUser = data.userData;
          updateUserDisplay();
        }
        
        loadCashoutHistory();
      } catch (error) {
        console.error('Cashout error:', error);
        showAlert('Network error. Please try again.');
      }
    }

    async function loadCashoutHistory() {
      if (!currentUser) return;
      
      try {
        const response = await fetch(SCRIPT_URL + '?action=getCashoutHistory&username=' + currentUser.username);
        const data = await response.json();
        const container = document.getElementById('cashoutHistory');
        
        if (data.status === 'success' && data.history && data.history.length > 0) {
          container.innerHTML = data.history.map(item => `
            <div class="history-item">
              <div class="flex justify-between items-center">
                <div>
                  <strong>${item.reward}</strong>
                  <span class="text-sm text-gray"> - $${item.amount}</span>
                </div>
                <span class="history-status status-${item.status.toLowerCase()}">${item.status}</span>
              </div>
              <div class="text-sm text-gray mt-2">
                ${new Date(item.date).toLocaleDateString()}
                ${item.adminNotes ? `<div class="mt-1"><strong>Note:</strong> ${item.adminNotes}</div>` : ''}
              </div>
            </div>
          `).join('');
        } else {
          container.innerHTML = '<p>No cashout history yet.</p>';
        }
      } catch (error) {
        console.error('Load history error:', error);
        container.innerHTML = '<p>Error loading history</p>';
      }
    }

    // Bonus codes functions
    async function loadBonusCodes() {
      if (!currentUser) return;
      
      try {
        // Load available codes
        const availableResponse = await fetch(SCRIPT_URL + '?action=getBonusCodes&username=' + currentUser.username);
        const availableData = await availableResponse.json();
        
        // Load history
        const historyResponse = await fetch(SCRIPT_URL + '?action=getUserBonusHistory&username=' + currentUser.username);
        const historyData = await historyResponse.json();
        
        updateAvailableCodes(availableData);
        updateBonusHistory(historyData);
        
      } catch (error) {
        console.error('Load bonus codes error:', error);
      }
    }

    function updateAvailableCodes(data) {
      const container = document.getElementById('availableBonusCodes');
      
      if (data.status === 'success' && data.availableCodes && data.availableCodes.length > 0) {
        container.innerHTML = data.availableCodes.map(code => `
          <div class="bonus-item">
            <div class="bonus-code">${code.code}</div>
            <div class="bonus-reward">+${code.points} Points</div>
          </div>
        `).join('');
      } else {
        container.innerHTML = '<p>No available bonus codes</p>';
      }
    }

    function updateBonusHistory(data) {
      const container = document.getElementById('bonusHistory');
      
      if (data.status === 'success' && data.history && data.history.length > 0) {
        container.innerHTML = data.history.map(item => `
          <div class="bonus-item">
            <div class="bonus-code">${item.code}</div>
            <div class="bonus-reward">+${item.points} Points</div>
            <div class="text-sm text-gray">${new Date(item.date).toLocaleDateString()}</div>
          </div>
        `).join('');
      } else {
        container.innerHTML = '<p>No bonus codes redeemed yet</p>';
      }
    }

    async function redeemBonusCode() {
      if (!currentUser) return;
      
      const bonusCode = document.getElementById('bonusCodeInput').value.trim();
      if (!bonusCode) {
        return showAlert('Please enter a bonus code');
      }

      // Disable button
      const btn = document.getElementById('redeemBonusBtn');
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Redeeming...';

      const formData = new FormData();
      formData.append('action', 'redeemBonusCode');
      formData.append('username', currentUser.username);
      formData.append('bonusCode', bonusCode);

      try {
        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const data = await response.json();

        if (data.status === 'success') {
          showAlert(data.message);
          document.getElementById('bonusCodeInput').value = '';
          
          // Update user data
          if (data.userData) {
            currentUser = data.userData;
            updateUserDisplay();
          }
          
          // Reload bonus codes
          loadBonusCodes();
        } else {
          showAlert(data.message || 'Failed to redeem bonus code');
        }
      } catch (error) {
        console.error('Redeem bonus error:', error);
        showAlert('Network error. Please try again.');
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-ticket-alt"></i> Redeem';
      }
    }

    // Chat functions
    function toggleChat() {
      document.getElementById('chatBox').classList.toggle('active');
    }

    function handleChatInput(event) {
      if (event.key === 'Enter') {
        sendChatMessage();
      }
    }

    async function sendChatMessage() {
      if (!currentUser) return;

      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (!message) return;
      
      const formData = new FormData();
      formData.append('action', 'sendChatMessage');
      formData.append('username', currentUser.username);
      formData.append('message', message);

      try {
        await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        input.value = '';
        loadChatMessages();
      } catch (error) {
        console.error('Chat error:', error);
      }
    }

    async function loadChatMessages() {
      if (!currentUser) return;
      
      try {
        const response = await fetch(SCRIPT_URL + '?action=getChatMessages');
        const data = await response.json();
        const container = document.getElementById('chatMessages');
        
        if (data.status === 'success') {
          container.innerHTML = data.messages.map(msg => `
            <div class="chat-message ${msg.username === currentUser.username ? 'own' : 'other'}">
              <strong>${msg.username}:</strong> ${msg.message}
            </div>
          `).join('');
          container.scrollTop = container.scrollHeight;
        }
      } catch (error) {
        console.error('Load chat error:', error);
      }
    }

    // Alert modal
    function showAlert(msg) {
      document.getElementById('alertMessage').textContent = msg;
      document.getElementById('alertModal').classList.add('active');
    }

    function closeAlert() {
      document.getElementById('alertModal').classList.remove('active');
    }

    function logout() {
      localStorage.removeItem('quizbux_user');
      if (screenStream) {
        screenStream.getTracks().forEach(track => track.stop());
      }
      if (chatInterval) clearInterval(chatInterval);
      location.reload();
    }

    // Offerwalls functions
    async function loadOfferwalls() {
      if (!currentUser) return;
      
      try {
        const response = await fetch(SCRIPT_URL + '?action=getOfferwalls&username=' + currentUser.username);
        const data = await response.json();
        const container = document.getElementById('offerwallList');
        
        if (data.status === 'success' && data.offerwalls && data.offerwalls.length > 0) {
          container.innerHTML = data.offerwalls.map(wall => {
            const hasEnoughPoints = (currentUser.balance || 0) >= (wall.pointsRequired || 0);
            const isUnlocked = hasEnoughPoints && wall.status === 'active';
            
            return `
              <div class="offerwall-card">
                <div class="offerwall-header">
                  <div class="offerwall-icon">
                    <i class="fas fa-gem"></i>
                  </div>
                  <div style="flex: 1;">
                    <h3 class="font-semibold">${wall.name}</h3>
                    <p class="text-sm text-gray">Complete offers to earn rewards</p>
                    ${wall.pointsRequired > 0 ? 
                      `<p class="text-xs text-gray">Requires ${wall.pointsRequired} points to unlock</p>` : 
                      ''}
                  </div>
                  <span class="offerwall-status ${isUnlocked ? 'unlocked' : 'locked'}">
                    ${isUnlocked ? 'Unlocked' : 'Locked'}
                  </span>
                </div>
                <div class="flex gap-2">
                  <button class="btn ${!isUnlocked ? 'btn-outline' : ''}" 
                          onclick="${isUnlocked ? `openOfferwall('${wall.id}', '${wall.url}')` : 'showAlert(\'Not enough points to unlock this offerwall\')'}" 
                          ${!isUnlocked ? 'disabled' : ''}>
                    <i class="fas fa-play"></i>
                    Start Earning
                  </button>
                  <button class="btn btn-outline" 
                          onclick="window.open('${wall.url}', '_blank')">
                    <i class="fas fa-external-link-alt"></i>
                  </button>
                </div>
              </div>
            `;
          }).join('');
        } else {
          container.innerHTML = '<p>No active offerwalls at the moment</p>';
        }
      } catch (error) {
        console.error('Load offerwalls error:', error);
        container.innerHTML = '<p>Error loading offerwalls</p>';
      }
    }

    function openOfferwall(id, url) {
      document.getElementById('offerwallList').classList.add('hidden');
      document.getElementById('iframeContainer').classList.remove('hidden');
      document.getElementById('offerwallFrame').src = url;
    }

    function closeIframe() {
      document.getElementById('offerwallList').classList.remove('hidden');
      document.getElementById('iframeContainer').classList.add('hidden');
      document.getElementById('offerwallFrame').src = '';
    }

    // Initialize
    window.onload = init;
  </script>
</body>
</html>
